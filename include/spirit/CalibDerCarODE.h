#ifndef CALIBDERCARODE_H__
#define CALIBDERCARODE_H__

#include <eigen3/Eigen/Eigen>
#include <spirit/spGeneralTools.h>
#include <spirit/Types/spTypes.h>
#include <spirit/ODEInterface.h>

class CalibDerODE : public ODEInterface {
public:

  CalibDerODE(){}

  ~CalibDerODE(){}

  const unsigned int StateSpaceSize(){
    return 11;
  }

  const unsigned int ParameterSpaceSize(){
    return 14;
  }

  const unsigned int InputSpaceSize(){
    return 2;
  }

  const bool HasJacobian(){
    return true;
  }

  void Run(Eigen::VectorXd& x_d_t, const Eigen::VectorXd& x_t, const Eigen::VectorXd& u_t){

    // state x_t includes state [x,z0,z1,...,z13]
    if(x_t.size() != (StateSpaceSize()+StateSpaceSize()*ParameterSpaceSize())){
      SPERROREXIT("State Space vector size mismatch! ");
    }
    if(u_t.size() != InputSpaceSize()){
      SPERROREXIT("Input signal vector size mismatch! ");
    }
    if(pp_.size() != ParameterSpaceSize()){
      SPERROREXIT("Parameter vector size mismatch! ");
    }

    double vx_i = x_t[0];
    double vy_i = x_t[1];
    double vw_i = x_t[2];
    double w0_i = x_t[3];
    double w1_i = x_t[4];
    double w2_i = x_t[5];
    double w3_i = x_t[6];
    double chi_i = x_t[9];
    double sigma_i = -u_t[0];//x_t[10];

    double Ix = pp_[0];
    double Iy = pp_[1];
    double Iw = pp_[2];
    double It = pp_[3];
    double mu_n_p0 = pp_[4];
    double mu_n_p1 = pp_[5];
    double mu_n_p2 = pp_[6];
    double mu_n_p3 = pp_[7];
    double mu_t_p0 = pp_[8];
    double mu_t_p1 = pp_[9];
    double mu_t_p2 = pp_[10];
    double mu_t_p3 = pp_[11];
    double str_del = pp_[12];
    double k_mot = pp_[13];

    double str_in = -u_t[0];
    double Curr_in = u_t[1];

    double r = 0.055;
    double theta = 0.97;
    double d = 0.2029;
    double m=4.392;

    // wrapping chi angle
//    double chi_mod = std::fmod(chi_i+SP_PI,2*SP_PI);
//    if(chi_mod<0){
//      chi_mod += 2*SP_PI;
//    }
//    chi_i = chi_mod - SP_PI;

    Eigen::VectorXd x_d(StateSpaceSize()) ;
    x_d = Eigen::VectorXd::Zero(StateSpaceSize());
//    x_d[0] = ((mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))*(vw_i*1.4147765383344E-1-vx_i+(r*w2_i)/It)-(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)))*(vw_i*1.4147765383344E-1+vx_i-(r*w1_i)/It)-cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vw_i*cos(sigma_i-1.57E2/2.0E2)*(1.0/5.0)+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i)/It)+cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vw_i*cos(sigma_i+1.57E2/2.0E2)*(1.0/5.0)-vx_i*cos(sigma_i)-vy_i*sin(sigma_i)+(r*w3_i)/It)+m*vw_i*vy_i-sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)),2.0)))*(vw_i*sin(sigma_i-1.57E2/2.0E2)*(1.0/5.0)-vy_i*cos(sigma_i)+vx_i*sin(sigma_i))+sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)),2.0)))*(vw_i*sin(sigma_i+1.57E2/2.0E2)*(1.0/5.0)+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)))/Ix;
//    x_d[1] = ((mu_t_p0+mu_t_p1/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))*(vw_i*1.413650362210732E-1-vy_i)+(mu_t_p0+mu_t_p1/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))*(vw_i*1.413650362210732E-1-cos(sigma_i)+vx_i*sin(sigma_i))-cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)),2.0)))*(vw_i*sin(sigma_i+1.57E2/2.0E2)*(1.0/5.0)+vy_i*cos(sigma_i)-vx_i*sin(sigma_i))-vw_i*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(cos(sigma_i-1.57E2/2.0E2)*(1.0/5.0)+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i)/It)+vw_i*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(cos(sigma_i+1.57E2/2.0E2)*(1.0/5.0)-vx_i*cos(sigma_i)-vy_i*sin(sigma_i)+(r*w3_i)/It)+vy_i*cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)),2.0)))*(-cos(sigma_i)+vw_i*sin(sigma_i-1.57E2/2.0E2)*(1.0/5.0)+vx_i*sin(sigma_i))-(Iw*m*vw_i*vx_i)/Ix)/Iy;
//    x_d[2] = -((mu_n_p0*1.4147765383344E-1+(mu_n_p1*1.4147765383344E-1)/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))*(vw_i*1.4147765383344E-1-vx_i+(r*w2_i)/It)+(mu_t_p0*1.413650362210732E-1+(mu_t_p1*1.413650362210732E-1)/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))*(vw_i*1.413650362210732E-1-vy_i)*2.0+(mu_n_p0*1.4147765383344E-1+(mu_n_p1*1.4147765383344E-1)/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)))*(vw_i*1.4147765383344E-1+vx_i-(r*w1_i)/It)+sin(sigma_i-1.57E2/2.0E2)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)),2.0)))*(vw_i*sin(sigma_i-1.57E2/2.0E2)*(1.0/5.0)-vy_i*cos(sigma_i)+vx_i*sin(sigma_i))*(1.0/5.0)+sin(sigma_i+1.57E2/2.0E2)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)),2.0)))*(vw_i*sin(sigma_i+1.57E2/2.0E2)*(1.0/5.0)+vy_i*cos(sigma_i)-vx_i*sin(sigma_i))*(1.0/5.0)+cos(sigma_i-1.57E2/2.0E2)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vw_i*cos(sigma_i-1.57E2/2.0E2)*(1.0/5.0)+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i)/It)*(1.0/5.0)+cos(sigma_i+1.57E2/2.0E2)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vw_i*cos(sigma_i+1.57E2/2.0E2)*(1.0/5.0)-vx_i*cos(sigma_i)-vy_i*sin(sigma_i)+(r*w3_i)/It)*(1.0/5.0))/Iw;
//    x_d[3] = Curr_in*k_mot+r*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vw_i*cos(sigma_i-1.57E2/2.0E2)*(1.0/5.0)+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i)/It);
//    x_d[4] = Curr_in*k_mot+r*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)))*(vw_i*1.4147765383344E-1+vx_i-(r*w1_i)/It);
//    x_d[5] = Curr_in*k_mot-r*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))*(vw_i*1.4147765383344E-1-vx_i+(r*w2_i)/It);
//    x_d[6] = Curr_in*k_mot-r*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vw_i*cos(sigma_i+1.57E2/2.0E2)*(1.0/5.0)-vx_i*cos(sigma_i)-vy_i*sin(sigma_i)+(r*w3_i)/It);
//    x_d[7] = cos(chi_i+atan(vy_i/vx_i))*sqrt(vx_i*vx_i+vy_i*vy_i);
//    x_d[8] = sin(chi_i+atan(vy_i/vx_i))*sqrt(vx_i*vx_i+vy_i*vy_i);
//    x_d[9] = vw_i;
//    x_d[10] = -(sigma_i-str_in)/str_del;

    x_d[0] = -(-(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))*(-vx_i+d*vw_i*cos(theta)+(r*w2_i)/It)+(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)))*(vx_i+d*vw_i*cos(theta)-(r*w1_i)/It)+sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)),2.0)))*(-vy_i*cos(sigma_i)+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta))+cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)-(r*w3_i)/It)+cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta)-(r*w0_i)/It)-sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)),2.0)))*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i+theta))-m*vw_i*vy_i)/Ix;
    x_d[1] = -((mu_t_p0+mu_t_p1/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))*(vy_i-d*vw_i*sin(theta))-(mu_t_p0+mu_t_p1/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))*(-cos(sigma_i)+vx_i*sin(sigma_i)+d*vw_i*sin(theta))+cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)),2.0)))*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i+theta))-vw_i*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(d*cos(sigma_i+theta)-vx_i*cos(sigma_i)-vy_i*sin(sigma_i)+(r*w3_i)/It)+vw_i*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*cos(sigma_i-theta)-(r*w0_i)/It)-vy_i*cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)),2.0)))*(-cos(sigma_i)+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta))+(Iw*m*vw_i*vx_i)/Ix)/Iy;
    x_d[2] = -(d*cos(sigma_i-theta)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta)-(r*w0_i)/It)+d*cos(theta)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))*(-vx_i+d*vw_i*cos(theta)+(r*w2_i)/It)-d*cos(sigma_i+theta)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)-(r*w3_i)/It)+d*sin(sigma_i-theta)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)),2.0)))*(-vy_i*cos(sigma_i)+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta))-d*sin(theta)*(mu_t_p0+mu_t_p1/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))*(vy_i-d*vw_i*sin(theta))*2.0+d*sin(sigma_i+theta)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)),2.0)))*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i+theta))+d*cos(theta)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)))*(vx_i+d*vw_i*cos(theta)-(r*w1_i)/It))/Iw;
    x_d[3] = Curr_in*k_mot+r*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta)-(r*w0_i)/It);
    x_d[4] = Curr_in*k_mot+r*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)))*(vx_i+d*vw_i*cos(theta)-(r*w1_i)/It);
    x_d[5] = Curr_in*k_mot-r*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))*(-vx_i+d*vw_i*cos(theta)+(r*w2_i)/It);
    x_d[6] = Curr_in*k_mot+r*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)-(r*w3_i)/It);
    x_d[7] = cos(chi_i+atan(vy_i/vx_i))*sqrt(vx_i*vx_i+vy_i*vy_i);
    x_d[8] = sin(chi_i+atan(vy_i/vx_i))*sqrt(vx_i*vx_i+vy_i*vy_i);
    x_d[9] = vw_i;
    x_d[10] = -(sigma_i-str_in)/str_del;


    Eigen::MatrixXd DfDp(StateSpaceSize(),ParameterSpaceSize());
    DfDp = Eigen::MatrixXd::Zero(StateSpaceSize(),ParameterSpaceSize());
//    DfDp(0,0) = 1.0/(Ix*Ix)*((mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)))*(vw_i*1.414776538334479E-1+vx_i-(r*w1_i*1.0)/It)*-1.0+(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))*(vw_i*1.414776538334479E-1-vx_i*1.0+(r*w2_i)/It)-sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1-vy_i*cos(sigma_i)*1.0+vx_i*sin(sigma_i))*1.0+sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)-cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*1.0+m*vw_i*vy_i+cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It))*-1.0;
//    DfDp(0,3) = (1.0/(It*It)*r*w1_i*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)))*-1.0-1.0/(It*It)*r*w2_i*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))*1.0-1.0/(It*It)*r*w0_i*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0-1.0/(It*It)*r*w3_i*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0)/Ix;
//    DfDp(0,4) = (vx_i*-2.0-cos(sigma_i)*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*1.0+cos(sigma_i)*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)+(r*w1_i)/It+(r*w2_i)/It)/Ix;
//    DfDp(0,5) = ((vw_i*-1.414776538334479E-1-vx_i*1.0+(r*w1_i*1.0)/It)/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0))+(vw_i*1.414776538334479E-1-vx_i*1.0+(r*w2_i*1.0)/It)/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0))+(cos(sigma_i)*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*1.0)/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0))-(cos(sigma_i)*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*1.0)/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))/Ix;
//    DfDp(0,6) = (mu_n_p1*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*(vw_i*1.414776538334479E-1+vx_i-(r*w1_i*1.0)/It)-mu_n_p1*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*(vw_i*1.414776538334479E-1-vx_i*1.0+(r*w2_i)/It)*1.0+mu_n_p1*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)-mu_n_p1*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*1.0)/Ix;
//    DfDp(0,7) = (mu_n_p1*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*pow((r*w1_i)/vx_i-1.0,2.0)*(vw_i*1.414776538334479E-1+vx_i-(r*w1_i*1.0)/It)-mu_n_p1*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*pow((r*w2_i)/vx_i-1.0,2.0)*(vw_i*1.414776538334479E-1-vx_i*1.0+(r*w2_i)/It)*1.0+mu_n_p1*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)-mu_n_p1*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*1.0)/Ix;
//    DfDp(0,8) = (sin(sigma_i)*(vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1-vy_i*cos(sigma_i)*1.0+vx_i*sin(sigma_i))*-1.0+sin(sigma_i)*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*1.0)/Ix;
//    DfDp(0,9) = ((sin(sigma_i)*(vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1-vy_i*cos(sigma_i)*1.0+vx_i*sin(sigma_i))*-1.0)/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0))+(sin(sigma_i)*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*1.0)/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))/Ix;
//    DfDp(0,10) = (mu_t_p1*sin(sigma_i)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1-vy_i*cos(sigma_i)*1.0+vx_i*sin(sigma_i))-mu_t_p1*sin(sigma_i)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*1.0)/Ix;
//    DfDp(0,11) = (mu_t_p1*sin(sigma_i)*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1-vy_i*cos(sigma_i)*1.0+vx_i*sin(sigma_i))-mu_t_p1*sin(sigma_i)*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*1.0)/Ix;
//    DfDp(1,0) = (Iw*1.0/(Ix*Ix)*m*vw_i*vx_i)/Iy;
//    DfDp(1,1) = 1.0/(Iy*Iy)*((mu_t_p0+mu_t_p1/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))*(vw_i*1.413650362210603E-1-vy_i*1.0)+(mu_t_p0+mu_t_p1/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))*(vw_i*1.413650362210603E-1-cos(sigma_i)*1.0+vx_i*sin(sigma_i))-cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*1.0+vy_i*cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(cos(sigma_i)*-1.0+vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*sin(sigma_i))-vw_i*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*1.0+vw_i*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)-(Iw*m*vw_i*vx_i*1.0)/Ix)*-1.0;
//    DfDp(1,2) = (m*vw_i*vx_i*-1.0)/(Ix*Iy);
//    DfDp(1,3) = (1.0/(It*It)*r*vw_i*w0_i*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*-1.0-1.0/(It*It)*r*vw_i*w3_i*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0)/Iy;
//    DfDp(1,4) = (vw_i*sin(sigma_i)*(cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*-1.0+vw_i*sin(sigma_i)*(cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*1.0)/Iy;
//    DfDp(1,5) = ((vw_i*sin(sigma_i)*(cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*-1.0)/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0))+(vw_i*sin(sigma_i)*(cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*1.0)/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))/Iy;
//    DfDp(1,6) = (mu_n_p1*vw_i*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*(cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)-mu_n_p1*vw_i*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*(cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*1.0)/Iy;
//    DfDp(1,7) = (mu_n_p1*vw_i*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)*(cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)-mu_n_p1*vw_i*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)*(cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*1.0)/Iy;
//    DfDp(1,8) = (vw_i*2.827300724421207E-1-vy_i*1.0-cos(sigma_i)*1.0-cos(sigma_i)*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*1.0+vx_i*sin(sigma_i)+vy_i*cos(sigma_i)*(cos(sigma_i)*-1.0+vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*sin(sigma_i)))/Iy;
//    DfDp(1,9) = ((vw_i*1.413650362210603E-1-vy_i*1.0)/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))+(vw_i*1.413650362210603E-1-cos(sigma_i)*1.0+vx_i*sin(sigma_i))/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))-(cos(sigma_i)*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*1.0)/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0))+(vy_i*cos(sigma_i)*(cos(sigma_i)*-1.0+vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*sin(sigma_i)))/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))/Iy;
//    DfDp(1,10) = (mu_t_p1*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0)*(vw_i*1.413650362210603E-1-vy_i*1.0)*-1.0-mu_t_p1*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0)*(vw_i*1.413650362210603E-1-cos(sigma_i)*1.0+vx_i*sin(sigma_i))*1.0+mu_t_p1*cos(sigma_i)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*1.0-mu_t_p1*vy_i*cos(sigma_i)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(cos(sigma_i)*-1.0+vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*sin(sigma_i))*1.0)/Iy;
//    DfDp(1,11) = (mu_t_p1*cos(sigma_i)*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*1.0-mu_t_p1*vy_i*cos(sigma_i)*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(cos(sigma_i)*-1.0+vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*sin(sigma_i))*1.0-(mu_t_p1*1.0/(vx_i*vx_i)*(vy_i*vy_i)*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0)*(vw_i*1.413650362210603E-1-vy_i*1.0)*1.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)-(mu_t_p1*1.0/(vx_i*vx_i)*(vy_i*vy_i)*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0)*(vw_i*1.413650362210603E-1-cos(sigma_i)*1.0+vx_i*sin(sigma_i))*1.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))/Iy;
//    DfDp(2,2) = 1.0/(Iw*Iw)*((mu_n_p0*1.414776538334479E-1+(mu_n_p1*1.414776538334479E-1)/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)))*(vw_i*1.414776538334479E-1+vx_i-(r*w1_i*1.0)/It)+(mu_t_p0*1.413650362210603E-1+(mu_t_p1*1.413650362210603E-1)/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))*(vw_i*1.413650362210603E-1-vy_i*1.0)*2.0+(mu_n_p0*1.414776538334479E-1+(mu_n_p1*1.414776538334479E-1)/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))*(vw_i*1.414776538334479E-1-vx_i*1.0+(r*w2_i)/It)+cos(sigma_i-7.849999999999682E-1)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*1.999999999999886E-1+cos(sigma_i+7.849999999999682E-1)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*1.999999999999886E-1+sin(sigma_i-7.849999999999682E-1)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1-vy_i*cos(sigma_i)*1.0+vx_i*sin(sigma_i))*1.999999999999886E-1+sin(sigma_i+7.849999999999682E-1)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*1.999999999999886E-1);
//    DfDp(2,3) = (1.0/(It*It)*r*w1_i*(mu_n_p0*1.414776538334479E-1+(mu_n_p1*1.414776538334479E-1)/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)))*-1.0+1.0/(It*It)*r*w2_i*(mu_n_p0*1.414776538334479E-1+(mu_n_p1*1.414776538334479E-1)/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))*1.0-1.0/(It*It)*r*w0_i*cos(sigma_i-7.849999999999682E-1)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.999999999999886E-1+1.0/(It*It)*r*w3_i*cos(sigma_i+7.849999999999682E-1)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.999999999999886E-1)/Iw;
//    DfDp(2,4) = (vw_i*-4.003185306842738E-2-cos(sigma_i+7.849999999999682E-1)*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*1.999999999999886E-1-cos(sigma_i-7.849999999999682E-1)*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*1.999999999999886E-1+(r*w1_i*1.414776538334479E-1)/It-(r*w2_i*1.414776538334479E-1)/It)/Iw;
//    DfDp(2,5) = ((vw_i*-2.001592653421692E-2-vx_i*1.414776538334479E-1+(r*w1_i*1.414776538334479E-1)/It)/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0))-(vw_i*2.001592653421692E-2-vx_i*1.414776538334479E-1+(r*w2_i*1.414776538334479E-1)/It)/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0))-(cos(sigma_i-7.849999999999682E-1)*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*1.999999999999886E-1)/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0))-(cos(sigma_i+7.849999999999682E-1)*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*1.999999999999886E-1)/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))/Iw;
//    DfDp(2,6) = (mu_n_p1*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*(vw_i*1.414776538334479E-1+vx_i-(r*w1_i*1.0)/It)*1.414776538334479E-1+mu_n_p1*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*(vw_i*1.414776538334479E-1-vx_i*1.0+(r*w2_i)/It)*1.414776538334479E-1+mu_n_p1*cos(sigma_i-7.849999999999682E-1)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*1.999999999999886E-1+mu_n_p1*cos(sigma_i+7.849999999999682E-1)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*1.999999999999886E-1)/Iw;
//    DfDp(2,7) = (mu_n_p1*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*pow((r*w1_i)/vx_i-1.0,2.0)*(vw_i*1.414776538334479E-1+vx_i-(r*w1_i*1.0)/It)*1.414776538334479E-1+mu_n_p1*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*pow((r*w2_i)/vx_i-1.0,2.0)*(vw_i*1.414776538334479E-1-vx_i*1.0+(r*w2_i)/It)*1.414776538334479E-1+mu_n_p1*cos(sigma_i-7.849999999999682E-1)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*1.999999999999886E-1+mu_n_p1*cos(sigma_i+7.849999999999682E-1)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*1.999999999999886E-1)/Iw;
//    DfDp(2,8) = (vw_i*-3.996814693157091E-2+vy_i*2.827300724421207E-1-sin(sigma_i-7.849999999999682E-1)*(vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1-vy_i*cos(sigma_i)*1.0+vx_i*sin(sigma_i))*1.999999999999886E-1-sin(sigma_i+7.849999999999682E-1)*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*1.999999999999886E-1)/Iw;
//    DfDp(2,9) = ((vw_i*-3.99681469315634E-2+vy_i*2.827300724421207E-1)/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))-(sin(sigma_i-7.849999999999682E-1)*(vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1-vy_i*cos(sigma_i)*1.0+vx_i*sin(sigma_i))*1.999999999999886E-1)/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0))-(sin(sigma_i+7.849999999999682E-1)*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*1.999999999999886E-1)/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))/Iw;
//    DfDp(2,10) = (mu_t_p1*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0)*(vw_i*1.413650362210603E-1-vy_i*1.0)*2.827300724421207E-1+mu_t_p1*sin(sigma_i-7.849999999999682E-1)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1-vy_i*cos(sigma_i)*1.0+vx_i*sin(sigma_i))*1.999999999999886E-1+mu_t_p1*sin(sigma_i+7.849999999999682E-1)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*1.999999999999886E-1)/Iw;
//    DfDp(2,11) = (mu_t_p1*sin(sigma_i-7.849999999999682E-1)*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1-vy_i*cos(sigma_i)*1.0+vx_i*sin(sigma_i))*1.999999999999886E-1+mu_t_p1*sin(sigma_i+7.849999999999682E-1)*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*1.999999999999886E-1+(mu_t_p1*1.0/(vx_i*vx_i)*(vy_i*vy_i)*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0)*(vw_i*1.413650362210603E-1-vy_i*1.0)*2.827300724421207E-1)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))/Iw;
//    DfDp(3,3) = 1.0/(It*It)*(r*r)*w0_i*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)));
//    DfDp(3,4) = r*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It);
//    DfDp(3,5) = (r*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It))/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0));
//    DfDp(3,6) = mu_n_p1*r*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*-1.0;
//    DfDp(3,7) = mu_n_p1*r*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*-1.0;
//    DfDp(3,13) = Curr_in;
//    DfDp(4,3) = 1.0/(It*It)*(r*r)*w1_i*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)));
//    DfDp(4,4) = r*(vw_i*1.414776538334479E-1+vx_i-(r*w1_i*1.0)/It);
//    DfDp(4,5) = (r*(vw_i*1.414776538334479E-1+vx_i-(r*w1_i*1.0)/It))/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0));
//    DfDp(4,6) = mu_n_p1*r*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*(vw_i*1.414776538334479E-1+vx_i-(r*w1_i*1.0)/It)*-1.0;
//    DfDp(4,7) = mu_n_p1*r*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*pow((r*w1_i)/vx_i-1.0,2.0)*(vw_i*1.414776538334479E-1+vx_i-(r*w1_i*1.0)/It)*-1.0;
//    DfDp(4,13) = Curr_in;
//    DfDp(5,3) = 1.0/(It*It)*(r*r)*w2_i*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)));
//    DfDp(5,4) = r*(vw_i*1.414776538334479E-1-vx_i*1.0+(r*w2_i)/It)*-1.0;
//    DfDp(5,5) = (r*(vw_i*1.414776538334479E-1-vx_i*1.0+(r*w2_i)/It)*-1.0)/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0));
//    DfDp(5,6) = mu_n_p1*r*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*(vw_i*1.414776538334479E-1-vx_i*1.0+(r*w2_i)/It);
//    DfDp(5,7) = mu_n_p1*r*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*pow((r*w2_i)/vx_i-1.0,2.0)*(vw_i*1.414776538334479E-1-vx_i*1.0+(r*w2_i)/It);
//    DfDp(5,13) = Curr_in;
//    DfDp(6,3) = 1.0/(It*It)*(r*r)*w3_i*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)));
//    DfDp(6,4) = r*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*-1.0;
//    DfDp(6,5) = (r*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*-1.0)/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0));
//    DfDp(6,6) = mu_n_p1*r*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It);
//    DfDp(6,7) = mu_n_p1*r*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It);
//    DfDp(6,13) = Curr_in;
//    DfDp(10,12) = 1.0/(str_del*str_del)*(sigma_i-str_in*1.0);

    DfDp(0,0) = 1.0/(Ix*Ix)*((mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)))*(vx_i+d*vw_i*cos(theta)-(r*w1_i*1.0)/It)-(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))*(vx_i*-1.0+d*vw_i*cos(theta)+(r*w2_i)/It)*1.0-sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))*1.0+cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It)-m*vw_i*vy_i*1.0+sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vy_i*cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))+cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It));
    DfDp(0,3) = (1.0/(It*It)*r*w1_i*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)))*-1.0-1.0/(It*It)*r*w2_i*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))*1.0-1.0/(It*It)*r*w0_i*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0-1.0/(It*It)*r*w3_i*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0)/Ix;
    DfDp(0,4) = (vx_i*-2.0-cos(sigma_i)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It)*1.0-cos(sigma_i)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It)*1.0+(r*w1_i*1.0)/It+(r*w2_i*1.0)/It)/Ix;
    DfDp(0,5) = ((vx_i*-1.0-d*vw_i*cos(theta)*1.0+(r*w1_i*1.0)/It)/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0))+(vx_i*-1.0+d*vw_i*cos(theta)*1.0+(r*w2_i*1.0)/It)/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0))-(cos(sigma_i)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It)*1.0)/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0))-(cos(sigma_i)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It)*1.0)/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))/Ix;
    DfDp(0,6) = (mu_n_p1*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*(vx_i*-1.0+d*vw_i*cos(theta)+(r*w2_i)/It)*-1.0+mu_n_p1*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*(vx_i+d*vw_i*cos(theta)-(r*w1_i*1.0)/It)+mu_n_p1*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It)+mu_n_p1*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It))/Ix;
    DfDp(0,7) = (mu_n_p1*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*pow((r*w1_i)/vx_i-1.0,2.0)*(vx_i+d*vw_i*cos(theta)-(r*w1_i*1.0)/It)-mu_n_p1*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*pow((r*w2_i)/vx_i-1.0,2.0)*(vx_i*-1.0+d*vw_i*cos(theta)+(r*w2_i)/It)*1.0+mu_n_p1*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It)+mu_n_p1*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It))/Ix;
    DfDp(0,8) = (sin(sigma_i)*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))-sin(sigma_i)*(vy_i*cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*1.0)/Ix;
    DfDp(0,9) = ((sin(sigma_i)*(vy_i*cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*-1.0)/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0))+(sin(sigma_i)*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))*1.0)/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))/Ix;
    DfDp(0,10) = (mu_t_p1*sin(sigma_i)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*1.0-mu_t_p1*sin(sigma_i)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))*1.0)/Ix;
    DfDp(0,11) = (mu_t_p1*sin(sigma_i)*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))*-1.0+mu_t_p1*sin(sigma_i)*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*1.0)/Ix;
    DfDp(1,0) = (Iw*1.0/(Ix*Ix)*m*vw_i*vx_i)/Iy;
    DfDp(1,1) = 1.0/(Iy*Iy)*((mu_t_p0+mu_t_p1/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))*(cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(theta))*-1.0+(vy_i-d*vw_i*sin(theta)*1.0)*(mu_t_p0+mu_t_p1/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))+cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))+vw_i*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(d*cos(sigma_i-theta*1.0)+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)-vy_i*cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*1.0-vw_i*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(d*cos(sigma_i+theta)-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*1.0+(Iw*m*vw_i*vx_i)/Ix);
    DfDp(1,2) = (m*vw_i*vx_i*-1.0)/(Ix*Iy);
    DfDp(1,3) = (1.0/(It*It)*r*vw_i*w0_i*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*-1.0-1.0/(It*It)*r*vw_i*w3_i*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0)/Iy;
    DfDp(1,4) = (vw_i*sin(sigma_i)*(d*cos(sigma_i+theta)-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*1.0-vw_i*sin(sigma_i)*(d*cos(sigma_i-theta*1.0)+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*1.0)/Iy;
    DfDp(1,5) = ((vw_i*sin(sigma_i)*(d*cos(sigma_i+theta)-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It))/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0))-(vw_i*sin(sigma_i)*(d*cos(sigma_i-theta*1.0)+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*1.0)/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))/Iy;
    DfDp(1,6) = (mu_n_p1*vw_i*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*(d*cos(sigma_i-theta*1.0)+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)-mu_n_p1*vw_i*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*(d*cos(sigma_i+theta)-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*1.0)/Iy;
    DfDp(1,7) = (mu_n_p1*vw_i*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)*(d*cos(sigma_i-theta*1.0)+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)-mu_n_p1*vw_i*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)*(d*cos(sigma_i+theta)-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*1.0)/Iy;
    DfDp(1,8) = (vy_i*-1.0-cos(sigma_i)*1.0-cos(sigma_i)*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))*1.0+vx_i*sin(sigma_i)*1.0+d*vw_i*sin(theta)*2.0+vy_i*cos(sigma_i)*(cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*1.0)/Iy;
    DfDp(1,9) = ((vy_i*-1.0+d*vw_i*sin(theta)*1.0)/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))+(cos(sigma_i)*-1.0+vx_i*sin(sigma_i)*1.0+d*vw_i*sin(theta)*1.0)/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))-(cos(sigma_i)*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))*1.0)/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0))+(vy_i*cos(sigma_i)*(cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*1.0)/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))/Iy;
    DfDp(1,10) = (mu_t_p1*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0)*(cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(theta))*-1.0+mu_t_p1*(vy_i-d*vw_i*sin(theta)*1.0)*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0)*1.0+mu_t_p1*cos(sigma_i)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))*1.0-mu_t_p1*vy_i*cos(sigma_i)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*1.0)/Iy;
    DfDp(1,11) = (mu_t_p1*cos(sigma_i)*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))+(mu_t_p1*1.0/(vx_i*vx_i)*(vy_i*vy_i)*(vy_i-d*vw_i*sin(theta)*1.0)*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)-mu_t_p1*vy_i*cos(sigma_i)*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*1.0-(mu_t_p1*1.0/(vx_i*vx_i)*(vy_i*vy_i)*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0)*(cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(theta))*1.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))/Iy;
    DfDp(2,2) = 1.0/(Iw*Iw)*(d*cos(sigma_i-theta*1.0)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It)-d*cos(sigma_i+theta)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It)*1.0-d*sin(theta)*(vy_i-d*vw_i*sin(theta)*1.0)*(mu_t_p0+mu_t_p1/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))*2.0+d*sin(sigma_i+theta)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))+d*cos(theta)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)))*(vx_i+d*vw_i*cos(theta)-(r*w1_i*1.0)/It)+d*sin(sigma_i-theta*1.0)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vy_i*cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))+d*cos(theta)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))*(vx_i*-1.0+d*vw_i*cos(theta)+(r*w2_i)/It));
    DfDp(2,3) = (1.0/(It*It)*d*r*w0_i*cos(sigma_i-theta*1.0)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*-1.0+1.0/(It*It)*d*r*w3_i*cos(sigma_i+theta)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0-1.0/(It*It)*d*r*w1_i*cos(theta)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)))*1.0+1.0/(It*It)*d*r*w2_i*cos(theta)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))*1.0)/Iw;
    DfDp(2,4) = (d*cos(theta)*(vx_i*-1.0+d*vw_i*cos(theta)+(r*w2_i)/It)*-1.0-d*cos(sigma_i-theta*1.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It)*1.0+d*cos(sigma_i+theta)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It)*1.0-d*cos(theta)*(vx_i+d*vw_i*cos(theta)-(r*w1_i*1.0)/It)*1.0)/Iw;
    DfDp(2,5) = ((d*cos(theta)*(vx_i*-1.0+d*vw_i*cos(theta)+(r*w2_i)/It)*-1.0)/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0))-(d*cos(sigma_i-theta*1.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It)*1.0)/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0))+(d*cos(sigma_i+theta)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It)*1.0)/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0))-(d*cos(theta)*(vx_i+d*vw_i*cos(theta)-(r*w1_i*1.0)/It)*1.0)/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)))/Iw;
    DfDp(2,6) = (d*mu_n_p1*cos(theta)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*(vx_i+d*vw_i*cos(theta)-(r*w1_i*1.0)/It)+d*mu_n_p1*cos(theta)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*(vx_i*-1.0+d*vw_i*cos(theta)+(r*w2_i)/It)+d*mu_n_p1*cos(sigma_i-theta*1.0)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It)-d*mu_n_p1*cos(sigma_i+theta)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It)*1.0)/Iw;
    DfDp(2,7) = (d*mu_n_p1*cos(theta)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*pow((r*w1_i)/vx_i-1.0,2.0)*(vx_i+d*vw_i*cos(theta)-(r*w1_i*1.0)/It)+d*mu_n_p1*cos(theta)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*pow((r*w2_i)/vx_i-1.0,2.0)*(vx_i*-1.0+d*vw_i*cos(theta)+(r*w2_i)/It)+d*mu_n_p1*cos(sigma_i-theta*1.0)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It)-d*mu_n_p1*cos(sigma_i+theta)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It)*1.0)/Iw;
    DfDp(2,8) = (d*sin(sigma_i+theta)*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))*-1.0-d*sin(sigma_i-theta*1.0)*(vy_i*cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*1.0+d*sin(theta)*(vy_i-d*vw_i*sin(theta)*1.0)*2.0)/Iw;
    DfDp(2,9) = ((d*sin(sigma_i-theta*1.0)*(vy_i*cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*-1.0)/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0))+(d*sin(theta)*(vy_i-d*vw_i*sin(theta)*1.0)*2.0)/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))-(d*sin(sigma_i+theta)*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))*1.0)/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))/Iw;
    DfDp(2,10) = (d*mu_t_p1*sin(sigma_i+theta)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))+d*mu_t_p1*sin(sigma_i-theta*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))-d*mu_t_p1*sin(theta)*(vy_i-d*vw_i*sin(theta)*1.0)*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0)*2.0)/Iw;
    DfDp(2,11) = (d*mu_t_p1*sin(sigma_i+theta)*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))+d*mu_t_p1*sin(sigma_i-theta*1.0)*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))-(d*mu_t_p1*1.0/(vx_i*vx_i)*(vy_i*vy_i)*sin(theta)*(vy_i-d*vw_i*sin(theta)*1.0)*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0)*2.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))/Iw;
    DfDp(3,3) = 1.0/(It*It)*(r*r)*w0_i*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)));
    DfDp(3,4) = r*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It);
    DfDp(3,5) = (r*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It))/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0));
    DfDp(3,6) = mu_n_p1*r*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It)*-1.0;
    DfDp(3,7) = mu_n_p1*r*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It)*-1.0;
    DfDp(3,13) = Curr_in;
    DfDp(4,3) = 1.0/(It*It)*(r*r)*w1_i*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)));
    DfDp(4,4) = r*(vx_i+d*vw_i*cos(theta)-(r*w1_i*1.0)/It);
    DfDp(4,5) = (r*(vx_i+d*vw_i*cos(theta)-(r*w1_i*1.0)/It))/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0));
    DfDp(4,6) = mu_n_p1*r*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*(vx_i+d*vw_i*cos(theta)-(r*w1_i*1.0)/It)*-1.0;
    DfDp(4,7) = mu_n_p1*r*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*pow((r*w1_i)/vx_i-1.0,2.0)*(vx_i+d*vw_i*cos(theta)-(r*w1_i*1.0)/It)*-1.0;
    DfDp(4,13) = Curr_in;
    DfDp(5,3) = 1.0/(It*It)*(r*r)*w2_i*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)));
    DfDp(5,4) = r*(vx_i*-1.0+d*vw_i*cos(theta)+(r*w2_i)/It)*-1.0;
    DfDp(5,5) = (r*(vx_i*-1.0+d*vw_i*cos(theta)+(r*w2_i)/It)*-1.0)/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0));
    DfDp(5,6) = mu_n_p1*r*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*(vx_i*-1.0+d*vw_i*cos(theta)+(r*w2_i)/It);
    DfDp(5,7) = mu_n_p1*r*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*pow((r*w2_i)/vx_i-1.0,2.0)*(vx_i*-1.0+d*vw_i*cos(theta)+(r*w2_i)/It);
    DfDp(5,13) = Curr_in;
    DfDp(6,3) = 1.0/(It*It)*(r*r)*w3_i*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)));
    DfDp(6,4) = r*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It);
    DfDp(6,5) = (r*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It))/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0));
    DfDp(6,6) = mu_n_p1*r*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It)*-1.0;
    DfDp(6,7) = mu_n_p1*r*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It)*-1.0;
    DfDp(6,13) = Curr_in;
    DfDp(10,12) = 1.0/(str_del*str_del)*(sigma_i-str_in*1.0);


    Eigen::MatrixXd DfDx(StateSpaceSize(),StateSpaceSize());
    DfDx = Eigen::MatrixXd::Zero(StateSpaceSize(),StateSpaceSize());
//    DfDx(0,0) = (mu_n_p0*-2.0-pow(cos(sigma_i),2.0)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0-pow(cos(sigma_i),2.0)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0-pow(sin(sigma_i),2.0)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*2.0-(mu_n_p1*1.0)/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0))-(mu_n_p1*1.0)/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0))+mu_n_p1*mu_n_p3*r*1.0/(vx_i*vx_i)*w2_i*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*((r*w2_i)/vx_i-1.0)*(vw_i*1.414776538334479E-1-vx_i*1.0+(r*w2_i)/It)*2.0-mu_n_p1*mu_n_p3*r*1.0/(vx_i*vx_i)*w1_i*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*((r*w1_i)/vx_i-1.0)*(vw_i*1.414776538334479E-1+vx_i-(r*w1_i*1.0)/It)*2.0-mu_n_p1*mu_n_p3*r*1.0/(vx_i*vx_i)*w0_i*pow(cos(sigma_i),2.0)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*2.0+mu_n_p1*mu_n_p3*r*1.0/(vx_i*vx_i)*w3_i*pow(cos(sigma_i),2.0)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*2.0+(mu_t_p1*mu_t_p3*1.0/(vx_i*vx_i)*vy_i*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1-vy_i*cos(sigma_i)*1.0+vx_i*sin(sigma_i))*2.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)-(mu_t_p1*mu_t_p3*1.0/(vx_i*vx_i)*vy_i*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*2.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))/Ix;
//    DfDx(0,1) = (m*vw_i+cos(sigma_i)*sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*2.0-cos(sigma_i)*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0-cos(sigma_i)*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0-(mu_t_p1*mu_t_p3*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1-vy_i*cos(sigma_i)*1.0+vx_i*sin(sigma_i))*2.0)/(vx_i*(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))+(mu_t_p1*mu_t_p3*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*2.0)/(vx_i*(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))/Ix;
//    DfDx(0,2) = (m*vy_i-(mu_n_p1*1.414776538334479E-1)/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0))+(mu_n_p1*1.414776538334479E-1)/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0))-cos(sigma_i-7.849999999999682E-1)*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.999999999999886E-1+cos(sigma_i+7.849999999999682E-1)*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.999999999999886E-1-sin(sigma_i-7.849999999999682E-1)*sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*1.999999999999886E-1+sin(sigma_i+7.849999999999682E-1)*sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*1.999999999999886E-1)/Ix;
//    DfDx(0,3) = ((r*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0))))/It+(mu_n_p1*mu_n_p3*r*pow(cos(sigma_i),2.0)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*2.0)/vx_i)/Ix;
//    DfDx(0,4) = ((r*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0))))/It+(mu_n_p1*mu_n_p3*r*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*((r*w1_i)/vx_i-1.0)*(vw_i*1.414776538334479E-1+vx_i-(r*w1_i*1.0)/It)*2.0)/vx_i)/Ix;
//    DfDx(0,5) = ((r*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0))))/It-(mu_n_p1*mu_n_p3*r*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*((r*w2_i)/vx_i-1.0)*(vw_i*1.414776538334479E-1-vx_i*1.0+(r*w2_i)/It)*2.0)/vx_i)/Ix;
//    DfDx(0,6) = ((r*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0))))/It-(mu_n_p1*mu_n_p3*r*pow(cos(sigma_i),2.0)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*2.0)/vx_i)/Ix;
//    DfDx(0,10) = (cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1-vy_i*cos(sigma_i)*1.0+vx_i*sin(sigma_i))*-1.0+cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*1.0+sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*1.0+cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1-vy_i*cos(sigma_i)*1.0+vx_i*sin(sigma_i))*1.0-cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*1.0-sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i))*1.0-sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vw_i*cos(sigma_i+7.849999999999682E-1)*-1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i))*1.0-sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*1.0+mu_t_p1*mu_t_p3*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1-vy_i*cos(sigma_i)*1.0+vx_i*sin(sigma_i))*2.0-mu_t_p1*mu_t_p3*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*2.0-(mu_n_p1*mu_n_p3*r*w0_i*cos(sigma_i)*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*2.0)/vx_i+(mu_n_p1*mu_n_p3*r*w3_i*cos(sigma_i)*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*2.0)/vx_i)/Ix;
//    DfDx(1,0) = (sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))+cos(sigma_i)*sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))+mu_t_p1*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0)*((mu_t_p3*1.0/(vx_i*vx_i*vx_i)*(vy_i*vy_i)*2.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)-mu_t_p3*1.0/(vx_i*vx_i*vx_i*vx_i*vx_i)*(vy_i*vy_i*vy_i*vy_i)*1.0/pow(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0,2.0)*2.0)*(vw_i*1.413650362210603E-1-cos(sigma_i)*1.0+vx_i*sin(sigma_i))-vw_i*cos(sigma_i)*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0-vw_i*cos(sigma_i)*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0-(Iw*m*vw_i*1.0)/Ix+vy_i*cos(sigma_i)*sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))+mu_t_p1*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0)*(vw_i*1.413650362210603E-1-vy_i*1.0)*((mu_t_p3*1.0/(vx_i*vx_i*vx_i)*(vy_i*vy_i)*2.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)-mu_t_p3*1.0/(vx_i*vx_i*vx_i*vx_i*vx_i)*(vy_i*vy_i*vy_i*vy_i)*1.0/pow(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0,2.0)*2.0)-(mu_t_p1*mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i)*cos(sigma_i)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(cos(sigma_i)*-1.0+vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*sin(sigma_i))*2.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)+(mu_t_p1*mu_t_p3*1.0/(vx_i*vx_i)*vy_i*cos(sigma_i)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*2.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)-mu_n_p1*mu_n_p3*r*vw_i*1.0/(vx_i*vx_i)*w0_i*cos(sigma_i)*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*2.0+mu_n_p1*mu_n_p3*r*vw_i*1.0/(vx_i*vx_i)*w3_i*cos(sigma_i)*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*2.0)/Iy;
//    DfDx(1,1) = (mu_t_p0*-1.0-pow(cos(sigma_i),2.0)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*1.0-(mu_t_p1*1.0)/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))+cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(cos(sigma_i)*-1.0+vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*sin(sigma_i))*1.0-vw_i*pow(sin(sigma_i),2.0)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0-vw_i*pow(sin(sigma_i),2.0)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0-mu_t_p1*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0)*((mu_t_p3*1.0/(vx_i*vx_i)*vy_i*2.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)-mu_t_p3*1.0/(vx_i*vx_i*vx_i*vx_i)*(vy_i*vy_i*vy_i)*1.0/pow(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0,2.0)*2.0)*(vw_i*1.413650362210603E-1-vy_i*1.0)*1.0-mu_t_p1*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0)*((mu_t_p3*1.0/(vx_i*vx_i)*vy_i*2.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)-mu_t_p3*1.0/(vx_i*vx_i*vx_i*vx_i)*(vy_i*vy_i*vy_i)*1.0/pow(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0,2.0)*2.0)*(vw_i*1.413650362210603E-1-cos(sigma_i)*1.0+vx_i*sin(sigma_i))*1.0-(mu_t_p1*mu_t_p3*cos(sigma_i)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*2.0)/(vx_i*(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))+(mu_t_p1*mu_t_p3*vy_i*cos(sigma_i)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(cos(sigma_i)*-1.0+vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*sin(sigma_i))*2.0)/(vx_i*(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))/Iy;
//    DfDx(1,2) = (mu_t_p0*2.827300724421207E-1+(mu_t_p1*2.827300724421207E-1)/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))-sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*1.0+sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)-sin(sigma_i+7.849999999999682E-1)*cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*1.999999999999886E-1-(Iw*m*vx_i*1.0)/Ix+vy_i*sin(sigma_i-7.849999999999682E-1)*cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*1.999999999999886E-1)/Iy;
//    DfDx(1,3) = ((r*vw_i*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0))))/It+(mu_n_p1*mu_n_p3*r*vw_i*cos(sigma_i)*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*2.0)/vx_i)/Iy;
//    DfDx(1,6) = ((r*vw_i*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0))))/It-(mu_n_p1*mu_n_p3*r*vw_i*cos(sigma_i)*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*2.0)/vx_i)/Iy;
//    DfDx(1,10) = ((mu_t_p0+mu_t_p1/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))*(sin(sigma_i)+vx_i*cos(sigma_i))+sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)+cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vw_i*cos(sigma_i+7.849999999999682E-1)*-1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i))-vy_i*sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(cos(sigma_i)*-1.0+vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*sin(sigma_i))*1.0+vy_i*cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(sin(sigma_i)+vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i))-vw_i*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*1.0+vw_i*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1-vy_i*cos(sigma_i)*1.0+vx_i*sin(sigma_i))-vw_i*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*1.0+vw_i*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)+mu_t_p1*mu_t_p3*cos(sigma_i)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*2.0-mu_t_p1*mu_t_p3*vy_i*cos(sigma_i)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(cos(sigma_i)*-1.0+vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*sin(sigma_i))*2.0-(mu_n_p1*mu_n_p3*r*vw_i*w0_i*pow(sin(sigma_i),2.0)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*2.0)/vx_i+(mu_n_p1*mu_n_p3*r*vw_i*w3_i*pow(sin(sigma_i),2.0)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*2.0)/vx_i)/Iy;
//    DfDx(2,0) = ((mu_n_p1*-1.414776538334479E-1)/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0))+(mu_n_p1*1.414776538334479E-1)/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0))-cos(sigma_i-7.849999999999682E-1)*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.999999999999886E-1+cos(sigma_i+7.849999999999682E-1)*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.999999999999886E-1-sin(sigma_i-7.849999999999682E-1)*sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*1.999999999999886E-1+sin(sigma_i+7.849999999999682E-1)*sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*1.999999999999886E-1-mu_t_p1*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0)*(vw_i*1.413650362210603E-1-vy_i*1.0)*((mu_t_p3*1.0/(vx_i*vx_i*vx_i)*(vy_i*vy_i)*2.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)-mu_t_p3*1.0/(vx_i*vx_i*vx_i*vx_i*vx_i)*(vy_i*vy_i*vy_i*vy_i)*1.0/pow(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0,2.0)*2.0)*2.827300724421207E-1-mu_n_p1*mu_n_p3*r*1.0/(vx_i*vx_i)*w2_i*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*((r*w2_i)/vx_i-1.0)*(vw_i*1.414776538334479E-1-vx_i*1.0+(r*w2_i)/It)*2.829553076668958E-1-mu_n_p1*mu_n_p3*r*1.0/(vx_i*vx_i)*w1_i*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*((r*w1_i)/vx_i-1.0)*(vw_i*1.414776538334479E-1+vx_i-(r*w1_i*1.0)/It)*2.829553076668958E-1+(mu_t_p1*mu_t_p3*1.0/(vx_i*vx_i)*vy_i*sin(sigma_i-7.849999999999682E-1)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1-vy_i*cos(sigma_i)*1.0+vx_i*sin(sigma_i))*3.999999999999773E-1)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)+(mu_t_p1*mu_t_p3*1.0/(vx_i*vx_i)*vy_i*sin(sigma_i+7.849999999999682E-1)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*3.999999999999773E-1)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)-mu_n_p1*mu_n_p3*r*1.0/(vx_i*vx_i)*w0_i*cos(sigma_i-7.849999999999682E-1)*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*3.999999999999773E-1-mu_n_p1*mu_n_p3*r*1.0/(vx_i*vx_i)*w3_i*cos(sigma_i+7.849999999999682E-1)*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*3.999999999999773E-1)/Iw;
//    DfDx(2,1) = (mu_t_p0*2.827300724421207E-1+(mu_t_p1*2.827300724421207E-1)/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))-cos(sigma_i-7.849999999999682E-1)*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.999999999999886E-1+cos(sigma_i+7.849999999999682E-1)*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.999999999999886E-1+sin(sigma_i-7.849999999999682E-1)*cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*1.999999999999886E-1-sin(sigma_i+7.849999999999682E-1)*cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*1.999999999999886E-1+mu_t_p1*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0)*((mu_t_p3*1.0/(vx_i*vx_i)*vy_i*2.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)-mu_t_p3*1.0/(vx_i*vx_i*vx_i*vx_i)*(vy_i*vy_i*vy_i)*1.0/pow(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0,2.0)*2.0)*(vw_i*1.413650362210603E-1-vy_i*1.0)*2.827300724421207E-1-(mu_t_p1*mu_t_p3*sin(sigma_i-7.849999999999682E-1)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1-vy_i*cos(sigma_i)*1.0+vx_i*sin(sigma_i))*3.999999999999773E-1)/(vx_i*(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))-(mu_t_p1*mu_t_p3*sin(sigma_i+7.849999999999682E-1)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*3.999999999999773E-1)/(vx_i*(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))/Iw;
//    DfDx(2,2) = (mu_n_p0*-4.003185306842738E-2-mu_t_p0*3.996814693157091E-2-pow(sin(sigma_i-7.849999999999682E-1),2.0)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*3.999999999999915E-2-pow(sin(sigma_i+7.849999999999682E-1),2.0)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*3.999999999999915E-2-(mu_t_p1*3.996814693157091E-2)/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))-pow(cos(sigma_i-7.849999999999682E-1),2.0)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*3.999999999999915E-2-pow(cos(sigma_i+7.849999999999682E-1),2.0)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*3.999999999999915E-2-(mu_n_p1*2.001592653421369E-2)/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0))-(mu_n_p1*2.001592653421369E-2)/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))/Iw;
//    DfDx(2,3) = ((r*cos(sigma_i-7.849999999999682E-1)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.999999999999886E-1)/It+(mu_n_p1*mu_n_p3*r*cos(sigma_i-7.849999999999682E-1)*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*3.999999999999773E-1)/vx_i)/Iw;
//    DfDx(2,4) = ((r*(mu_n_p0*1.414776538334479E-1+(mu_n_p1*1.414776538334479E-1)/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0))))/It+(mu_n_p1*mu_n_p3*r*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*((r*w1_i)/vx_i-1.0)*(vw_i*1.414776538334479E-1+vx_i-(r*w1_i*1.0)/It)*2.829553076668958E-1)/vx_i)/Iw;
//    DfDx(2,5) = ((r*(mu_n_p0*1.414776538334479E-1+(mu_n_p1*1.414776538334479E-1)/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))*-1.0)/It+(mu_n_p1*mu_n_p3*r*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*((r*w2_i)/vx_i-1.0)*(vw_i*1.414776538334479E-1-vx_i*1.0+(r*w2_i)/It)*2.829553076668958E-1)/vx_i)/Iw;
//    DfDx(2,6) = ((r*cos(sigma_i+7.849999999999682E-1)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*-1.999999999999886E-1)/It+(mu_n_p1*mu_n_p3*r*cos(sigma_i+7.849999999999682E-1)*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*3.999999999999773E-1)/vx_i)/Iw;
//    DfDx(2,10) = (sin(sigma_i-7.849999999999682E-1)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*1.999999999999886E-1+cos(sigma_i-7.849999999999682E-1)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1-vy_i*cos(sigma_i)*1.0+vx_i*sin(sigma_i))*1.999999999999886E-1+cos(sigma_i+7.849999999999682E-1)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*1.999999999999886E-1-sin(sigma_i-7.849999999999682E-1)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i))*1.999999999999886E-1+sin(sigma_i+7.849999999999682E-1)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vw_i*cos(sigma_i+7.849999999999682E-1)*-1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i))*1.999999999999886E-1+sin(sigma_i+7.849999999999682E-1)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*1.999999999999886E-1-cos(sigma_i-7.849999999999682E-1)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1-vy_i*cos(sigma_i)*1.0+vx_i*sin(sigma_i))*1.999999999999886E-1-cos(sigma_i+7.849999999999682E-1)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*1.999999999999886E-1+mu_t_p1*mu_t_p3*sin(sigma_i-7.849999999999682E-1)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1-vy_i*cos(sigma_i)*1.0+vx_i*sin(sigma_i))*3.999999999999773E-1+mu_t_p1*mu_t_p3*sin(sigma_i+7.849999999999682E-1)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*3.999999999999773E-1-(mu_n_p1*mu_n_p3*r*w3_i*cos(sigma_i+7.849999999999682E-1)*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*3.999999999999773E-1)/vx_i-(mu_n_p1*mu_n_p3*r*w0_i*cos(sigma_i-7.849999999999682E-1)*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*3.999999999999773E-1)/vx_i)/Iw;
//    DfDx(3,0) = r*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))+mu_n_p1*mu_n_p3*(r*r)*1.0/(vx_i*vx_i)*w0_i*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*2.0;
//    DfDx(3,1) = r*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)));
//    DfDx(3,2) = r*cos(sigma_i-7.849999999999682E-1)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.999999999999886E-1;
//    DfDx(3,3) = ((r*r)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*-1.0)/It-(mu_n_p1*mu_n_p3*(r*r)*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*2.0)/vx_i;
//    DfDx(3,10) = r*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vw_i*sin(sigma_i-7.849999999999682E-1)*1.999999999999886E-1-vy_i*cos(sigma_i)*1.0+vx_i*sin(sigma_i))*-1.0+(mu_n_p1*mu_n_p3*(r*r)*w0_i*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(vw_i*cos(sigma_i-7.849999999999682E-1)*1.999999999999886E-1+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*2.0)/vx_i;
//    DfDx(4,0) = r*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)))+mu_n_p1*mu_n_p3*(r*r)*1.0/(vx_i*vx_i)*w1_i*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*((r*w1_i)/vx_i-1.0)*(vw_i*1.414776538334479E-1+vx_i-(r*w1_i*1.0)/It)*2.0;
//    DfDx(4,2) = r*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)))*1.414776538334479E-1;
//    DfDx(4,4) = ((r*r)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)))*-1.0)/It-(mu_n_p1*mu_n_p3*(r*r)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*((r*w1_i)/vx_i-1.0)*(vw_i*1.414776538334479E-1+vx_i-(r*w1_i*1.0)/It)*2.0)/vx_i;
//    DfDx(5,0) = r*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))-mu_n_p1*mu_n_p3*(r*r)*1.0/(vx_i*vx_i)*w2_i*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*((r*w2_i)/vx_i-1.0)*(vw_i*1.414776538334479E-1-vx_i*1.0+(r*w2_i)/It)*2.0;
//    DfDx(5,2) = r*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))*-1.414776538334479E-1;
//    DfDx(5,5) = ((r*r)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))*-1.0)/It+(mu_n_p1*mu_n_p3*(r*r)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*((r*w2_i)/vx_i-1.0)*(vw_i*1.414776538334479E-1-vx_i*1.0+(r*w2_i)/It)*2.0)/vx_i;
//    DfDx(6,0) = r*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))-mu_n_p1*mu_n_p3*(r*r)*1.0/(vx_i*vx_i)*w3_i*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*2.0;
//    DfDx(6,1) = r*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)));
//    DfDx(6,2) = r*cos(sigma_i+7.849999999999682E-1)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*-1.999999999999886E-1;
//    DfDx(6,6) = ((r*r)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*-1.0)/It+(mu_n_p1*mu_n_p3*(r*r)*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*2.0)/vx_i;
//    DfDx(6,10) = r*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vw_i*sin(sigma_i+7.849999999999682E-1)*1.999999999999886E-1+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)-(mu_n_p1*mu_n_p3*(r*r)*w3_i*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(vw_i*cos(sigma_i+7.849999999999682E-1)*1.999999999999886E-1-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*2.0)/vx_i;
//    DfDx(7,0) = vx_i*cos(chi_i+atan(vy_i/vx_i))*1.0/sqrt(vx_i*vx_i+vy_i*vy_i)+(1.0/(vx_i*vx_i)*vy_i*sin(chi_i+atan(vy_i/vx_i))*sqrt(vx_i*vx_i+vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0);
//    DfDx(7,1) = vy_i*cos(chi_i+atan(vy_i/vx_i))*1.0/sqrt(vx_i*vx_i+vy_i*vy_i)-(sin(chi_i+atan(vy_i/vx_i))*sqrt(vx_i*vx_i+vy_i*vy_i)*1.0)/(vx_i*(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0));
//    DfDx(7,9) = sin(chi_i+atan(vy_i/vx_i))*sqrt(vx_i*vx_i+vy_i*vy_i)*-1.0;
//    DfDx(8,0) = vx_i*sin(chi_i+atan(vy_i/vx_i))*1.0/sqrt(vx_i*vx_i+vy_i*vy_i)-(1.0/(vx_i*vx_i)*vy_i*cos(chi_i+atan(vy_i/vx_i))*sqrt(vx_i*vx_i+vy_i*vy_i)*1.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0);
//    DfDx(8,1) = vy_i*sin(chi_i+atan(vy_i/vx_i))*1.0/sqrt(vx_i*vx_i+vy_i*vy_i)+(cos(chi_i+atan(vy_i/vx_i))*sqrt(vx_i*vx_i+vy_i*vy_i))/(vx_i*(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0));
//    DfDx(8,9) = cos(chi_i+atan(vy_i/vx_i))*sqrt(vx_i*vx_i+vy_i*vy_i);
//    DfDx(9,2) = 1.0;
//    DfDx(10,10) = -1.0/str_del;

    DfDx(0,0) = (mu_n_p0*-2.0-pow(cos(sigma_i),2.0)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0-pow(cos(sigma_i),2.0)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0-pow(sin(sigma_i),2.0)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*2.0-(mu_n_p1*1.0)/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0))-(mu_n_p1*1.0)/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0))+mu_n_p1*mu_n_p3*r*1.0/(vx_i*vx_i)*w2_i*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*((r*w2_i)/vx_i-1.0)*(vx_i*-1.0+d*vw_i*cos(theta)+(r*w2_i)/It)*2.0-mu_n_p1*mu_n_p3*r*1.0/(vx_i*vx_i)*w1_i*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*((r*w1_i)/vx_i-1.0)*(vx_i+d*vw_i*cos(theta)-(r*w1_i*1.0)/It)*2.0-mu_n_p1*mu_n_p3*r*1.0/(vx_i*vx_i)*w0_i*pow(cos(sigma_i),2.0)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It)*2.0-mu_n_p1*mu_n_p3*r*1.0/(vx_i*vx_i)*w3_i*pow(cos(sigma_i),2.0)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It)*2.0+(mu_t_p1*mu_t_p3*1.0/(vx_i*vx_i)*vy_i*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*2.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)-(mu_t_p1*mu_t_p3*1.0/(vx_i*vx_i)*vy_i*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))*2.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))/Ix;
    DfDx(0,1) = (m*vw_i+cos(sigma_i)*sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*2.0-cos(sigma_i)*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0-cos(sigma_i)*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0+(mu_t_p1*mu_t_p3*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))*2.0)/(vx_i*(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))-(mu_t_p1*mu_t_p3*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*2.0)/(vx_i*(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))/Ix;
    DfDx(0,2) = (m*vy_i-d*cos(theta)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)))*1.0+d*cos(theta)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))+d*sin(sigma_i+theta)*sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))-d*cos(sigma_i-theta*1.0)*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0+d*cos(sigma_i+theta)*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))-d*sin(sigma_i-theta*1.0)*sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*1.0)/Ix;
    DfDx(0,3) = ((r*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0))))/It+(mu_n_p1*mu_n_p3*r*pow(cos(sigma_i),2.0)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It)*2.0)/vx_i)/Ix;
    DfDx(0,4) = ((r*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0))))/It+(mu_n_p1*mu_n_p3*r*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*((r*w1_i)/vx_i-1.0)*(vx_i+d*vw_i*cos(theta)-(r*w1_i*1.0)/It)*2.0)/vx_i)/Ix;
    DfDx(0,5) = ((r*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0))))/It-(mu_n_p1*mu_n_p3*r*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*((r*w2_i)/vx_i-1.0)*(vx_i*-1.0+d*vw_i*cos(theta)+(r*w2_i)/It)*2.0)/vx_i)/Ix;
    DfDx(0,6) = ((r*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0))))/It+(mu_n_p1*mu_n_p3*r*pow(cos(sigma_i),2.0)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It)*2.0)/vx_i)/Ix;
    DfDx(0,10) = (cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))*1.0-sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0)*1.0+sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It)*1.0+cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vy_i*cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*1.0-sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0))*1.0-cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vy_i*cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*1.0-cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))*1.0+sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It)*1.0-mu_t_p1*mu_t_p3*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))*2.0+mu_t_p1*mu_t_p3*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*2.0-(mu_n_p1*mu_n_p3*r*w3_i*cos(sigma_i)*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It)*2.0)/vx_i-(mu_n_p1*mu_n_p3*r*w0_i*cos(sigma_i)*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It)*2.0)/vx_i)/Ix;
    DfDx(1,0) = (sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))+cos(sigma_i)*sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))+mu_t_p1*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0)*((mu_t_p3*1.0/(vx_i*vx_i*vx_i)*(vy_i*vy_i)*2.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)-mu_t_p3*1.0/(vx_i*vx_i*vx_i*vx_i*vx_i)*(vy_i*vy_i*vy_i*vy_i)*1.0/pow(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0,2.0)*2.0)*(cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(theta))-vw_i*cos(sigma_i)*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0-vw_i*cos(sigma_i)*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0-(Iw*m*vw_i*1.0)/Ix+vy_i*cos(sigma_i)*sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))-mu_t_p1*(vy_i-d*vw_i*sin(theta)*1.0)*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0)*((mu_t_p3*1.0/(vx_i*vx_i*vx_i)*(vy_i*vy_i)*2.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)-mu_t_p3*1.0/(vx_i*vx_i*vx_i*vx_i*vx_i)*(vy_i*vy_i*vy_i*vy_i)*1.0/pow(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0,2.0)*2.0)*1.0-(mu_t_p1*mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i)*cos(sigma_i)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*2.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)+(mu_t_p1*mu_t_p3*1.0/(vx_i*vx_i)*vy_i*cos(sigma_i)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))*2.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)+mu_n_p1*mu_n_p3*r*vw_i*1.0/(vx_i*vx_i)*w3_i*cos(sigma_i)*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(d*cos(sigma_i+theta)-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*2.0-mu_n_p1*mu_n_p3*r*vw_i*1.0/(vx_i*vx_i)*w0_i*cos(sigma_i)*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(d*cos(sigma_i-theta*1.0)+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*2.0)/Iy;
    DfDx(1,1) = (mu_t_p0*-1.0-pow(cos(sigma_i),2.0)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*1.0-(mu_t_p1*1.0)/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))+cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*1.0-vw_i*pow(sin(sigma_i),2.0)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0-vw_i*pow(sin(sigma_i),2.0)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0+mu_t_p1*(vy_i-d*vw_i*sin(theta)*1.0)*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0)*((mu_t_p3*1.0/(vx_i*vx_i)*vy_i*2.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)-mu_t_p3*1.0/(vx_i*vx_i*vx_i*vx_i)*(vy_i*vy_i*vy_i)*1.0/pow(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0,2.0)*2.0)*1.0-mu_t_p1*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0)*((mu_t_p3*1.0/(vx_i*vx_i)*vy_i*2.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)-mu_t_p3*1.0/(vx_i*vx_i*vx_i*vx_i)*(vy_i*vy_i*vy_i)*1.0/pow(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0,2.0)*2.0)*(cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(theta))*1.0-(mu_t_p1*mu_t_p3*cos(sigma_i)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))*2.0)/(vx_i*(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))+(mu_t_p1*mu_t_p3*vy_i*cos(sigma_i)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*2.0)/(vx_i*(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))/Iy;
    DfDx(1,2) = (sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(d*cos(sigma_i+theta)-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*1.0-sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(d*cos(sigma_i-theta*1.0)+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*1.0+d*sin(theta)*(mu_t_p0+mu_t_p1/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))*2.0-(Iw*m*vx_i*1.0)/Ix-d*sin(sigma_i+theta)*cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*1.0+d*vy_i*sin(sigma_i-theta*1.0)*cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*1.0)/Iy;
    DfDx(1,3) = ((r*vw_i*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0))))/It+(mu_n_p1*mu_n_p3*r*vw_i*cos(sigma_i)*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(d*cos(sigma_i-theta*1.0)+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*2.0)/vx_i)/Iy;
    DfDx(1,6) = ((r*vw_i*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0))))/It-(mu_n_p1*mu_n_p3*r*vw_i*cos(sigma_i)*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(d*cos(sigma_i+theta)-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*2.0)/vx_i)/Iy;
    DfDx(1,10) = ((mu_t_p0+mu_t_p1/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))*(sin(sigma_i)+vx_i*cos(sigma_i))+cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0)+sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))+vy_i*cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(sin(sigma_i)+vx_i*cos(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0))-vw_i*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(d*cos(sigma_i-theta*1.0)+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*1.0+vw_i*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(d*sin(sigma_i-theta*1.0)-vy_i*cos(sigma_i)*1.0+vx_i*sin(sigma_i))-vy_i*sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*1.0-vw_i*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(d*sin(sigma_i+theta)+vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0)*1.0+vw_i*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(d*cos(sigma_i+theta)-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)+mu_t_p1*mu_t_p3*cos(sigma_i)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))*2.0-mu_t_p1*mu_t_p3*vy_i*cos(sigma_i)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*2.0-(mu_n_p1*mu_n_p3*r*vw_i*w0_i*pow(sin(sigma_i),2.0)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(d*cos(sigma_i-theta*1.0)+vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-(r*w0_i*1.0)/It)*2.0)/vx_i+(mu_n_p1*mu_n_p3*r*vw_i*w3_i*pow(sin(sigma_i),2.0)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(d*cos(sigma_i+theta)-vx_i*cos(sigma_i)*1.0-vy_i*sin(sigma_i)*1.0+(r*w3_i)/It)*2.0)/vx_i)/Iy;
    DfDx(2,0) = (d*cos(theta)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)))*-1.0+d*cos(theta)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))+d*sin(sigma_i+theta)*sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))-d*cos(sigma_i-theta*1.0)*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0+d*cos(sigma_i+theta)*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))-d*sin(sigma_i-theta*1.0)*sin(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*1.0+d*mu_t_p1*sin(theta)*(vy_i-d*vw_i*sin(theta)*1.0)*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0)*((mu_t_p3*1.0/(vx_i*vx_i*vx_i)*(vy_i*vy_i)*2.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)-mu_t_p3*1.0/(vx_i*vx_i*vx_i*vx_i*vx_i)*(vy_i*vy_i*vy_i*vy_i)*1.0/pow(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0,2.0)*2.0)*2.0-d*mu_n_p1*mu_n_p3*r*1.0/(vx_i*vx_i)*w1_i*cos(theta)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*((r*w1_i)/vx_i-1.0)*(vx_i+d*vw_i*cos(theta)-(r*w1_i*1.0)/It)*2.0-d*mu_n_p1*mu_n_p3*r*1.0/(vx_i*vx_i)*w2_i*cos(theta)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*((r*w2_i)/vx_i-1.0)*(vx_i*-1.0+d*vw_i*cos(theta)+(r*w2_i)/It)*2.0+(d*mu_t_p1*mu_t_p3*1.0/(vx_i*vx_i)*vy_i*sin(sigma_i-theta*1.0)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*2.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)-d*mu_n_p1*mu_n_p3*r*1.0/(vx_i*vx_i)*w0_i*cos(sigma_i-theta*1.0)*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It)*2.0+d*mu_n_p1*mu_n_p3*r*1.0/(vx_i*vx_i)*w3_i*cos(sigma_i+theta)*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It)*2.0+(d*mu_t_p1*mu_t_p3*1.0/(vx_i*vx_i)*vy_i*sin(sigma_i+theta)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))*2.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))/Iw;
    DfDx(2,1) = (d*sin(theta)*(mu_t_p0+mu_t_p1/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))*2.0-d*sin(sigma_i+theta)*cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*1.0-d*cos(sigma_i-theta*1.0)*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0+d*sin(sigma_i-theta*1.0)*cos(sigma_i)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*1.0+d*cos(sigma_i+theta)*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0-d*mu_t_p1*sin(theta)*(vy_i-d*vw_i*sin(theta)*1.0)*1.0/pow(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0),2.0)*((mu_t_p3*1.0/(vx_i*vx_i)*vy_i*2.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)-mu_t_p3*1.0/(vx_i*vx_i*vx_i*vx_i)*(vy_i*vy_i*vy_i)*1.0/pow(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0,2.0)*2.0)*2.0-(d*mu_t_p1*mu_t_p3*sin(sigma_i+theta)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))*2.0)/(vx_i*(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0))-(d*mu_t_p1*mu_t_p3*sin(sigma_i-theta*1.0)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*2.0)/(vx_i*(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))/Iw;
    DfDx(2,2) = ((d*d)*pow(cos(theta),2.0)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)))*-1.0-(d*d)*pow(cos(theta),2.0)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))*1.0-(d*d)*pow(sin(sigma_i+theta),2.0)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*1.0-(d*d)*pow(cos(sigma_i-theta*1.0),2.0)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0-(d*d)*pow(sin(theta),2.0)*(mu_t_p0+mu_t_p1/(mu_t_p2+(mu_t_p3*1.0/(vx_i*vx_i)*(vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0)))*2.0-(d*d)*pow(cos(sigma_i+theta),2.0)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*1.0-(d*d)*pow(sin(sigma_i-theta*1.0),2.0)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*1.0)/Iw;
    DfDx(2,3) = ((d*r*cos(sigma_i-theta*1.0)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0))))/It+(d*mu_n_p1*mu_n_p3*r*cos(sigma_i-theta*1.0)*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It)*2.0)/vx_i)/Iw;
    DfDx(2,4) = ((d*r*cos(theta)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0))))/It+(d*mu_n_p1*mu_n_p3*r*cos(theta)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*((r*w1_i)/vx_i-1.0)*(vx_i+d*vw_i*cos(theta)-(r*w1_i*1.0)/It)*2.0)/vx_i)/Iw;
    DfDx(2,5) = ((d*r*cos(theta)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))*-1.0)/It+(d*mu_n_p1*mu_n_p3*r*cos(theta)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*((r*w2_i)/vx_i-1.0)*(vx_i*-1.0+d*vw_i*cos(theta)+(r*w2_i)/It)*2.0)/vx_i)/Iw;
    DfDx(2,6) = ((d*r*cos(sigma_i+theta)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*-1.0)/It-(d*mu_n_p1*mu_n_p3*r*cos(sigma_i+theta)*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It)*2.0)/vx_i)/Iw;
    DfDx(2,10) = (d*sin(sigma_i-theta*1.0)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It)-d*sin(sigma_i+theta)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It)*1.0+d*cos(sigma_i-theta*1.0)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vy_i*cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))-d*sin(sigma_i-theta*1.0)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0))*1.0-d*cos(sigma_i+theta)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))*1.0+d*sin(sigma_i+theta)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0)-d*cos(sigma_i-theta*1.0)*(mu_t_p0+mu_t_p1/(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0)))*(vy_i*cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*1.0+d*cos(sigma_i+theta)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))+d*mu_t_p1*mu_t_p3*sin(sigma_i+theta)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))*2.0+d*mu_t_p1*mu_t_p3*sin(sigma_i-theta*1.0)*cos(sigma_i-atan(vy_i/vx_i)*1.0)*sin(sigma_i-atan(vy_i/vx_i)*1.0)*1.0/pow(mu_t_p2+mu_t_p3*pow(sin(sigma_i-atan(vy_i/vx_i)*1.0),2.0),2.0)*(vy_i*cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*2.0-(d*mu_n_p1*mu_n_p3*r*w0_i*cos(sigma_i-theta*1.0)*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It)*2.0)/vx_i+(d*mu_n_p1*mu_n_p3*r*w3_i*cos(sigma_i+theta)*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It)*2.0)/vx_i)/Iw;
    DfDx(3,0) = r*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))+mu_n_p1*mu_n_p3*(r*r)*1.0/(vx_i*vx_i)*w0_i*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It)*2.0;
    DfDx(3,1) = r*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)));
    DfDx(3,2) = d*r*cos(sigma_i-theta*1.0)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)));
    DfDx(3,3) = ((r*r)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*-1.0)/It-(mu_n_p1*mu_n_p3*(r*r)*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It)*2.0)/vx_i;
    DfDx(3,10) = r*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vy_i*cos(sigma_i)*-1.0+vx_i*sin(sigma_i)+d*vw_i*sin(sigma_i-theta*1.0))*-1.0+(mu_n_p1*mu_n_p3*(r*r)*w0_i*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w0_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w0_i*cos(sigma_i))/vx_i-1.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)+d*vw_i*cos(sigma_i-theta*1.0)-(r*w0_i*1.0)/It)*2.0)/vx_i;
    DfDx(4,0) = r*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)))+mu_n_p1*mu_n_p3*(r*r)*1.0/(vx_i*vx_i)*w1_i*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*((r*w1_i)/vx_i-1.0)*(vx_i+d*vw_i*cos(theta)-(r*w1_i*1.0)/It)*2.0;
    DfDx(4,2) = d*r*cos(theta)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)));
    DfDx(4,4) = ((r*r)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0)))*-1.0)/It-(mu_n_p1*mu_n_p3*(r*r)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w1_i)/vx_i-1.0,2.0),2.0)*((r*w1_i)/vx_i-1.0)*(vx_i+d*vw_i*cos(theta)-(r*w1_i*1.0)/It)*2.0)/vx_i;
    DfDx(5,0) = r*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))-mu_n_p1*mu_n_p3*(r*r)*1.0/(vx_i*vx_i)*w2_i*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*((r*w2_i)/vx_i-1.0)*(vx_i*-1.0+d*vw_i*cos(theta)+(r*w2_i)/It)*2.0;
    DfDx(5,2) = d*r*cos(theta)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))*-1.0;
    DfDx(5,5) = ((r*r)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0)))*-1.0)/It+(mu_n_p1*mu_n_p3*(r*r)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w2_i)/vx_i-1.0,2.0),2.0)*((r*w2_i)/vx_i-1.0)*(vx_i*-1.0+d*vw_i*cos(theta)+(r*w2_i)/It)*2.0)/vx_i;
    DfDx(6,0) = r*cos(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))+mu_n_p1*mu_n_p3*(r*r)*1.0/(vx_i*vx_i)*w3_i*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It)*2.0;
    DfDx(6,1) = r*sin(sigma_i)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)));
    DfDx(6,2) = d*r*cos(sigma_i+theta)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*-1.0;
    DfDx(6,6) = ((r*r)*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*-1.0)/It-(mu_n_p1*mu_n_p3*(r*r)*cos(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It)*2.0)/vx_i;
    DfDx(6,10) = r*(mu_n_p0+mu_n_p1/(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0)))*(vy_i*cos(sigma_i)-vx_i*sin(sigma_i)*1.0+d*vw_i*sin(sigma_i+theta))+(mu_n_p1*mu_n_p3*(r*r)*w3_i*sin(sigma_i)*1.0/pow(mu_n_p2+mu_n_p3*pow((r*w3_i*cos(sigma_i))/vx_i-1.0,2.0),2.0)*((r*w3_i*cos(sigma_i))/vx_i-1.0)*(vx_i*cos(sigma_i)+vy_i*sin(sigma_i)-d*vw_i*cos(sigma_i+theta)*1.0-(r*w3_i*1.0)/It)*2.0)/vx_i;
    DfDx(7,0) = vx_i*cos(chi_i+atan(vy_i/vx_i))*1.0/sqrt(vx_i*vx_i+vy_i*vy_i)+(1.0/(vx_i*vx_i)*vy_i*sin(chi_i+atan(vy_i/vx_i))*sqrt(vx_i*vx_i+vy_i*vy_i))/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0);
    DfDx(7,1) = vy_i*cos(chi_i+atan(vy_i/vx_i))*1.0/sqrt(vx_i*vx_i+vy_i*vy_i)-(sin(chi_i+atan(vy_i/vx_i))*sqrt(vx_i*vx_i+vy_i*vy_i)*1.0)/(vx_i*(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0));
    DfDx(7,9) = sin(chi_i+atan(vy_i/vx_i))*sqrt(vx_i*vx_i+vy_i*vy_i)*-1.0;
    DfDx(8,0) = vx_i*sin(chi_i+atan(vy_i/vx_i))*1.0/sqrt(vx_i*vx_i+vy_i*vy_i)-(1.0/(vx_i*vx_i)*vy_i*cos(chi_i+atan(vy_i/vx_i))*sqrt(vx_i*vx_i+vy_i*vy_i)*1.0)/(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0);
    DfDx(8,1) = vy_i*sin(chi_i+atan(vy_i/vx_i))*1.0/sqrt(vx_i*vx_i+vy_i*vy_i)+(cos(chi_i+atan(vy_i/vx_i))*sqrt(vx_i*vx_i+vy_i*vy_i))/(vx_i*(1.0/(vx_i*vx_i)*(vy_i*vy_i)+1.0));
    DfDx(8,9) = cos(chi_i+atan(vy_i/vx_i))*sqrt(vx_i*vx_i+vy_i*vy_i);
    DfDx(9,2) = 1.0;
    DfDx(10,10) = -1.0/str_del;

    x_d_t.segment(0,StateSpaceSize()) = x_d;

    for(int ii=0; ii<ParameterSpaceSize(); ii++){
//      x_d_t.segment((ii+1)*11,11)  = DfDx*x_t.segment((ii+1)*11,11)+ DfDp.block<11,1>(0,ii);
      x_d_t.segment((ii+1)*StateSpaceSize(),StateSpaceSize()) = DfDx*x_t.segment((ii+1)*StateSpaceSize(),StateSpaceSize()) + DfDp.col(ii);
    }
  }

};
#endif //CALIBDERCARODE_H__
